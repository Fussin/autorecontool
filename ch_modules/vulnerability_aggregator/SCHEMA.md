```markdown
# Unified Vulnerability Schema for CyberHunter 3D

This document defines the standard JSON schema used to represent individual vulnerability findings aggregated from various scanning modules within the CyberHunter 3D platform.

## Schema Definition

A single vulnerability finding is represented as a JSON object with the following fields:

-   **`id`** (string, required):
    A unique identifier for this specific vulnerability instance (e.g., a UUID). This helps in tracking and managing the vulnerability across different scans or systems.
    *Example: "f47ac10b-58cc-4372-a567-0e02b2c3d479"*

-   **`vulnerability_type`** (string, required):
    A standardized name for the type of vulnerability.
    *Examples: "Cross-Site Scripting (XSS) - Reflected", "SQL Injection (SQLi) - Error-Based", "Local File Inclusion (LFI)", "CORS Misconfiguration - Wildcard Origin", "Sensitive Data Exposure - API Key", "Server-Side Request Forgery (SSRF)", "XML External Entity (XXE) Injection", "Remote Code Execution (RCE) - Command Injection"*

-   **`description`** (string, required):
    A human-readable description of the vulnerability, explaining what it is, how it was found (briefly), and its potential impact.
    *Example: "A reflected Cross-Site Scripting (XSS) vulnerability was identified in the 'query' parameter of the search page. An attacker can inject arbitrary JavaScript code that will be executed in the victim's browser."*

-   **`target_url`** (string, required):
    The full URL of the affected endpoint, page, or resource.
    *Example: "https://example.com/search?query=<script>alert(1)</script>"*

-   **`affected_component`** (string, optional):
    Specifies the vulnerable component, which could be a parameter, header, cookie, or a more general description like "Request Body (JSON)".
    *Example: "Parameter: query", "Header: X-Forwarded-For", "Cookie: session_id"*

-   **`payload`** (string, optional):
    The specific payload or input that was used to trigger or identify the vulnerability.
    *Example: "' OR 1=1 --", "<script>alert('XSS')</script>", "../../../../etc/passwd"*

-   **`evidence`** (string, optional):
    Textual evidence supporting the finding. This could be a snippet of the server's response, an error message, or a brief explanation of how the vulnerability was confirmed. For binary evidence (like screenshots), this field might contain a path or reference.
    *Example: "Server responded with error: You have an error in your SQL syntax...", "The string 'root:x:0:0' was found in the response."*

-   **`severity`** (enum string, required):
    The assessed severity level of the vulnerability.
    Allowed values: `"Critical"`, `"High"`, `"Medium"`, `"Low"`, `"Informational"`
    *Example: "High"*

-   **`confidence`** (enum string, required):
    The level of confidence in the finding's accuracy (i.e., likelihood it's a true positive).
    Allowed values: `"High"` (confirmed), `"Medium"` (likely, needs review), `"Low"` (potential, needs significant review)
    *Example: "High"*

-   **`source_modules`** (array of strings, required):
    A list of internal module names or tools that reported this vulnerability. If a finding is merged from multiple sources, all sources are listed.
    *Example: `["XSS Hunter", "Manual Verification"]`, `["SQLi Scanner"]`*

-   **`first_seen_timestamp`** (string, ISO 8601 datetime, required):
    The timestamp when this specific vulnerability was first detected by the platform.
    *Example: "2023-10-26T10:00:00Z"*

-   **`last_seen_timestamp`** (string, ISO 8601 datetime, required):
    The timestamp when this specific vulnerability was last observed or confirmed. For new findings, this will be the same as `first_seen_timestamp`.
    *Example: "2023-10-26T10:00:00Z"*

-   **`status`** (enum string, required):
    The current status of the vulnerability in its lifecycle.
    Allowed values: `"New"`, `"Confirmed"`, `"False Positive"`, `"Remediated"`, `"Mitigated"`, `"Accepted Risk"`
    *Example: "New"*

-   **`cwe_ids`** (array of integers, optional):
    A list of Common Weakness Enumeration (CWE) identifiers relevant to this vulnerability.
    *Example: `[79, 89]`*

-   **`cvss_vector`** (string, optional):
    The CVSS (Common Vulnerability Scoring System) vector string (e.g., CVSS v3.1).
    *Example: "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N"*

-   **`cvss_score`** (float, optional):
    The calculated CVSS base score.
    *Example: 6.1*

-   **`remediation_advice`** (string, optional):
    General or specific advice on how to remediate the vulnerability. This can include links to detailed guidance.
    *Example: "Properly sanitize user input by using output encoding relevant to the context where the data is displayed. Consider implementing a Content Security Policy (CSP). See: https://owasp.org/www-community/attacks/xss/"*

-   **`tags`** (array of strings, optional):
    Arbitrary tags for categorization or filtering.
    *Example: `["PII_Exposure", "Needs Manual Review", "OWASP_Top_10_2021_A03"]`*

-   **`scan_id`** (string, required):
    The ID of the scan job that produced this finding.
    *Example: "scan_job_abcdef123456"*

## Example JSON Object

```json
{
  "id": "a1b2c3d4-e5f6-7890-1234-567890abcdef",
  "vulnerability_type": "Cross-Site Scripting (XSS) - Reflected",
  "description": "A reflected XSS vulnerability was found in the 'search_term' parameter. User-supplied input is not properly sanitized before being reflected in the page, allowing for arbitrary script execution.",
  "target_url": "https://vulnerable.example.com/search?search_term=%3Cscript%3Ealert%28document.cookie%29%3C%2Fscript%3E",
  "affected_component": "Parameter: search_term",
  "payload": "<script>alert(document.cookie)</script>",
  "evidence": "The payload was successfully executed in a test browser, and an alert box with cookie data appeared.",
  "severity": "Medium",
  "confidence": "High",
  "source_modules": ["XSS Hunter"],
  "first_seen_timestamp": "2024-07-10T14:30:00Z",
  "last_seen_timestamp": "2024-07-10T14:30:00Z",
  "status": "New",
  "cwe_ids": [79],
  "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
  "cvss_score": 6.1,
  "remediation_advice": "Encode user input before rendering it back to the page. Implement a strict Content Security Policy. Refer to OWASP XSS Prevention Cheat Sheet.",
  "tags": ["OWASP_A03:2021", "BrowserExecution"],
  "scan_id": "0ad533fb-c497-4764-90e8-f2e01b18823e"
}
```

This schema will serve as the common language for all vulnerabilities processed by the Vulnerability Aggregation & Deduplication module.
```
